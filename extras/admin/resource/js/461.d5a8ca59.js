"use strict";(globalThis["webpackChunkideahut_quasar_template"]=globalThis["webpackChunkideahut_quasar_template"]||[]).push([[461],{7461:(e,s,o)=>{o.r(s),o.d(s,{default:()=>F});var t=o(1758);const r={key:0,class:"flex flex-center q-mt-xl"},n={class:"login-form text-center"};function i(e,s,o,i,a,l){const u=(0,t.g2)("q-icon"),p=(0,t.g2)("q-input"),d=(0,t.g2)("q-form"),_=(0,t.g2)("q-btn");return i.is_show_login?((0,t.uX)(),(0,t.CE)("div",r,[(0,t.Lk)("div",n,[(0,t.bF)(d,{class:"q-mt-lg",onSubmit:l.on_login_click},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:i.username,"onUpdate:modelValue":s[0]||(s[0]=e=>i.username=e),class:"q-mb-md",type:"text",placeholder:e.$t("label.username"),rounded:"",outlined:""},{prepend:(0,t.k6)((()=>[(0,t.bF)(u,{name:"account_box"})])),_:1},8,["modelValue","placeholder"])])),_:1},8,["onSubmit"]),(0,t.bF)(d,{onSubmit:l.on_login_click},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:i.password,"onUpdate:modelValue":s[2]||(s[2]=e=>i.password=e),class:"q-mb-md",type:i.is_show_password?"text":"password",placeholder:e.$t("label.password"),rounded:"",outlined:""},{prepend:(0,t.k6)((()=>[(0,t.bF)(u,{name:"lock"})])),append:(0,t.k6)((()=>[(0,t.bF)(u,{name:i.is_show_password?"visibility":"visibility_off",onClick:s[1]||(s[1]=e=>i.is_show_password=!i.is_show_password)},null,8,["name"])])),_:1},8,["modelValue","type","placeholder"])])),_:1},8,["onSubmit"]),(0,t.bF)(_,{"no-caps":"",ripple:"",color:"primary",onClick:l.on_login_click,loading:i.is_in_progress,label:e.$t("label.login")},null,8,["onClick","loading","label"])])])):(0,t.Q3)("",!0)}o(239),o(4702);var a=o(8734),l=o(9928),u=o(8916),p=o(526),d=o(8889);const _={setup(){return{util:l.Z,uix:u.L,username:(0,a.KR)(null),password:(0,a.KR)(null),is_show_login:(0,a.KR)(!1),is_in_progress:(0,a.KR)(!1),is_show_password:(0,a.KR)(!1),is_basic_auth:(0,a.KR)(!1)}},beforeCreate(){let e=this;p.F.send({path:"/check",onSuccess(s){let o=s?.headers?s.headers:{};if(l.Z.isString(o["auth-token"])){let s={token:atob(o["auth-token"]),persistent:!0,logout:!1};d.I.auth(s),e.$router.push({path:"/"})}else e.is_show_login=!0},onError(s){let o=s?.response?s.response:{};if(401===o.status){let s=o?.headers?o.headers:{};if(l.Z.isString(s["www-authenticate"])){let o=s["www-authenticate"],t=o.toLowerCase(),r=t.indexOf(" "),n="";-1!=r&&(n=t.substring(0,r)),"basic"===n?(e.is_show_login=!0,e.is_basic_auth=!0):u.L.notify(e.$t("error.unsupported_authentication_type"),o,!1)}else e.is_show_login=!0}else e.is_show_login=!0}})},methods:{on_login_click(){let e=this,s=e.username;if(!(s&&s.length>0))return u.L.error("error.required","label.username"),!1;let o=e.password;if(!(o&&o.length>0))return u.L.error("error.required","label.password"),!1;if(e.is_in_progress=!0,e.is_basic_auth){let t=s+":"+o,r={token:"Basic "+btoa(t),persistent:!0,logout:!0};d.I.auth(r),p.F.send({path:"/check",onFinish(){e.is_in_progress=!1},onSuccess(){e.$router.push({path:"/"})},onError(){u.L.error("error.invalid_authentication")}})}else p.F.call({path:"/login",method:"post",params:{username:s,password:o},onFinish(){e.is_in_progress=!1},onSuccess(s){l.Z.isString(s)&&""!==s&&(d.I.auth({token:s,persistent:!1,logout:!0}),e.$router.push({path:"/"}))}})}}};var c=o(2807),h=o(1565),b=o(8020),m=o(4609),g=o(9001),w=o(8582),k=o.n(w);const f=(0,c.A)(_,[["render",i]]),F=f;k()(_,"components",{QForm:h.A,QInput:b.A,QIcon:m.A,QBtn:g.A})}}]);