"use strict";(globalThis["webpackChunkideahut_quasar_admin"]=globalThis["webpackChunkideahut_quasar_admin"]||[]).push([[282],{1901:(e,l,a)=>{a.r(l),a.d(l,{default:()=>G});var t=a(1758),o=a(8790);const i={class:"bg-primary"},n={class:"q-pa-xs bg-white row"},s={class:"col-6 text-left"},d={class:"col-6 text-right"},r={key:0,class:"q-mb-xs",style:{width:"100%"}},p={key:1,class:"q-mb-xs",style:{width:"100%"}},u={class:"col-4 q-pr-xs text-left"},c={class:"col-4 q-pr-xs text-center"},m={class:"col-4 q-pl-xs text-right"};function b(e,l,a,b,_,f){const g=(0,t.g2)("q-item-label"),k=(0,t.g2)("q-item-section"),v=(0,t.g2)("q-tooltip"),y=(0,t.g2)("q-btn"),h=(0,t.g2)("q-item"),V=(0,t.g2)("q-card-section"),w=(0,t.g2)("q-input"),x=(0,t.g2)("q-select"),q=(0,t.g2)("q-tab"),F=(0,t.g2)("q-tabs"),C=(0,t.g2)("q-separator"),A=(0,t.g2)("q-date"),Q=(0,t.g2)("q-tab-panel"),U=(0,t.g2)("q-time"),X=(0,t.g2)("q-tab-panels"),W=(0,t.g2)("q-popup-proxy"),Z=(0,t.g2)("q-icon"),$=(0,t.g2)("q-fab-action"),j=(0,t.g2)("q-fab"),K=(0,t.g2)("q-card-actions"),L=(0,t.g2)("q-card"),R=(0,t.g2)("Pick"),T=(0,t.g2)("q-dialog"),E=(0,t.g2)("Table2"),S=(0,t.g2)("FormE"),I=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)(L,{style:(0,o.Tr)("width: "+(e.$q.screen.lt.md?"100%;":"50%;"))},{default:(0,t.k6)((()=>[(0,t.bF)(V,{class:"header-main"},{default:(0,t.k6)((()=>[(0,t.bF)(h,{class:"q-pr-none"},{default:(0,t.k6)((()=>[(0,t.bF)(k,null,{default:(0,t.k6)((()=>[(0,t.bF)(g,{class:"text-h6 text-white"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(b.is_edit?e.$t("label.edit"):e.$t("label.new")),1)])),_:1})])),_:1}),(0,t.bF)(k,{side:""},{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(y,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close",disable:b.saving},{default:(0,t.k6)((()=>[(0,t.bF)(v,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.$t("label.close")),1)])),_:1})])),_:1},8,["disable"])),[[I]])])),_:1})])),_:1})])),_:1}),(0,t.bF)(V,{style:{"max-height":"65vh"},class:"q-pa-xs q-mt-none scroll"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(b.fields,((l,a)=>((0,t.uX)(),(0,t.CE)("div",{key:a,class:"q-mb-xs",style:{width:"100%"}},["words"===l.type?((0,t.uX)(),(0,t.Wv)(w,{key:0,type:"text",label:l.label,readonly:!l.editable,modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,filled:"",autogrow:"",style:{"max-height":"120px",overflow:"scroll"}},null,8,["label","readonly","modelValue","onUpdate:modelValue"])):"option"===l.type?((0,t.uX)(),(0,t.Wv)(x,{key:1,modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,label:l.label,readonly:!l.editable,options:b.options[l.option],"option-value":"value","option-label":"label","emit-value":"","map-options":"",filled:""},null,8,["modelValue","onUpdate:modelValue","label","readonly","options"])):"enum"===l.type?((0,t.uX)(),(0,t.Wv)(x,{key:2,modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,label:l.label,readonly:!l.editable,options:b.enums[l.enum],"option-value":"value","option-label":"label","emit-value":"","map-options":"",filled:""},null,8,["modelValue","onUpdate:modelValue","label","readonly","options"])):"datetime"===l.type||"date"===l.type||"time"===l.type?((0,t.uX)(),(0,t.Wv)(w,{key:3,type:"text",label:l.label,readonly:!l.editable,modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,filled:""},{append:(0,t.k6)((()=>[(0,t.bF)(Z,{name:"time"===l.type?"schedule":"date"===l.type?"calendar_month":"event",class:"cursor-pointer"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{"transition-show":"scale","transition-hide":"scale",cover:"",onBeforeShow:e=>{l.proxy_value=l.value,l.tab="time"===l.type?"time":"date"}},{default:(0,t.k6)((()=>[(0,t.Lk)("div",i,[(0,t.bF)(F,{modelValue:l.tab,"onUpdate:modelValue":e=>l.tab=e,class:"bg-primary text-grey-5 shadow-2 text-subtitle2","no-caps":"","indicator-color":"transparent","active-color":"white"},{default:(0,t.k6)((()=>["datetime"===l.type||"date"===l.type?((0,t.uX)(),(0,t.Wv)(q,{key:0,name:"date"},{default:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.$t("label.date")),1)])),_:1})):(0,t.Q3)("",!0),"datetime"===l.type||"time"===l.type?((0,t.uX)(),(0,t.Wv)(q,{key:1,name:"time"},{default:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.$t("label.time")),1)])),_:1})):(0,t.Q3)("",!0)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.bF)(C),(0,t.bF)(X,{modelValue:l.tab,"onUpdate:modelValue":e=>l.tab=e},{default:(0,t.k6)((()=>["datetime"===l.type||"date"===l.type?((0,t.uX)(),(0,t.Wv)(Q,{key:0,name:"date",class:"q-pa-none"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{modelValue:l.proxy_value,"onUpdate:modelValue":e=>l.proxy_value=e,mask:l.pattern,square:""},null,8,["modelValue","onUpdate:modelValue","mask"])])),_:2},1024)):(0,t.Q3)("",!0),"datetime"===l.type||"time"===l.type?((0,t.uX)(),(0,t.Wv)(Q,{key:1,name:"time",class:"q-pa-none"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:l.proxy_value,"onUpdate:modelValue":e=>l.proxy_value=e,mask:l.pattern,format24h:"",square:""},null,8,["modelValue","onUpdate:modelValue","mask"])])),_:2},1024)):(0,t.Q3)("",!0)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.bF)(C),(0,t.Lk)("div",n,[(0,t.Lk)("div",s,[(0,t.bo)((0,t.bF)(y,{label:e.$t("label.cancel"),color:"negative","no-caps":""},null,8,["label"]),[[I]])]),(0,t.Lk)("div",d,[(0,t.bo)((0,t.bF)(y,{label:e.$t("label.ok"),color:"secondary","no-caps":"",onClick:e=>l.value=l.proxy_value},null,8,["label","onClick"]),[[I]])])])])])),_:2},1032,["onBeforeShow"])])),_:2},1032,["name"])])),_:2},1032,["label","readonly","modelValue","onUpdate:modelValue"])):"pick"===l.type?((0,t.uX)(),(0,t.Wv)(w,{key:4,type:"text",label:l.label,readonly:!l.editable,modelValue:l.text,"onUpdate:modelValue":e=>l.text=e,filled:"",autogrow:""},(0,t.eX)({_:2},[l.editable?{name:"append",fn:(0,t.k6)((()=>[(0,t.bF)(j,{modelValue:l.fab,"onUpdate:modelValue":e=>l.fab=e,icon:"flaky",direction:"left",padding:"none",round:"",dense:"",flat:"",glossy:"",class:"q-ma-none q-pa-none"},{default:(0,t.k6)((()=>[(0,t.bF)($,{color:"secondary",icon:"fact_check",round:"",dense:"",glossy:"",onClick:e=>f.on_pick_select_click(l)},{default:(0,t.k6)((()=>[(0,t.bF)(v,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.$t("label.select")),1)])),_:1})])),_:2},1032,["onClick"]),l.value?((0,t.uX)(),(0,t.Wv)($,{key:0,color:"negative",icon:"delete_forever",round:"",dense:"",glossy:"",onClick:e=>f.on_pick_remove_click(l)},{default:(0,t.k6)((()=>[(0,t.bF)(v,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.$t("label.delete")),1)])),_:1})])),_:2},1032,["onClick"])):(0,t.Q3)("",!0)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),key:"0"}:void 0]),1032,["label","readonly","modelValue","onUpdate:modelValue"])):((0,t.uX)(),(0,t.Wv)(w,{key:5,type:l.type,label:l.label,readonly:!l.editable,modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,filled:""},null,8,["type","label","readonly","modelValue","onUpdate:modelValue"]))])))),128)),b.is_edit&&b.template.forms?.length?((0,t.uX)(),(0,t.CE)("div",r,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(b.template.forms,((e,l)=>((0,t.uX)(),(0,t.Wv)(y,{key:l,label:e.title,class:"full-width q-mt-xs q-mb-xs text-weight-bold","no-caps":"",glossy:"",loading:b.loading["form_"+l],onClick:a=>f.on_form_click(e,l)},null,8,["label","loading","onClick"])))),128))])):(0,t.Q3)("",!0),b.is_edit&&b.template.children?.length?((0,t.uX)(),(0,t.CE)("div",p,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(b.template.children,((e,l)=>((0,t.uX)(),(0,t.Wv)(y,{key:l,label:e.title,class:"full-width q-mt-xs q-mb-xs text-weight-bold","no-caps":"",glossy:"",onClick:l=>f.on_table_click(e)},null,8,["label","onClick"])))),128))])):(0,t.Q3)("",!0)])),_:1}),(0,t.bF)(C),(0,t.bF)(K,{class:"row"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",u,[(0,t.bo)((0,t.bF)(y,{label:e.$t("label.cancel"),color:"negative","no-caps":"",glossy:"",disable:b.saving},null,8,["label","disable"]),[[I]])]),(0,t.Lk)("div",c,[b.is_edit&&!1!==b.template.copy?((0,t.uX)(),(0,t.Wv)(y,{key:0,label:e.$t("label.copy"),color:"purple","no-caps":"",glossy:"",disable:b.saving,onClick:f.on_clone_click},null,8,["label","disable","onClick"])):(0,t.Q3)("",!0)]),(0,t.Lk)("div",m,[(0,t.bF)(y,{label:e.$t("label.save"),color:"secondary","no-caps":"",glossy:"",loading:b.saving,onClick:f.on_save_click},null,8,["label","loading","onClick"])])])),_:1})])),_:1},8,["style"]),(0,t.bF)(T,{modelValue:b.dialog.pick.show,"onUpdate:modelValue":l[0]||(l[0]=e=>b.dialog.pick.show=e),persistent:"","transition-show":"slide-down","transition-hide":"none"},{default:(0,t.k6)((()=>[(0,t.bF)(R,{parameters:b.dialog.pick.parameters,onClose:f.on_close_dialog_pick},null,8,["parameters","onClose"])])),_:1},8,["modelValue"]),(0,t.bF)(T,{modelValue:b.dialog.table.show,"onUpdate:modelValue":l[1]||(l[1]=e=>b.dialog.table.show=e),"transition-show":"slide-down","transition-hide":"none","full-height":"","full-width":""},{default:(0,t.k6)((()=>[(0,t.bF)(E,{parameters:b.dialog.table.parameters,onClose:f.on_close_dialog_table},null,8,["parameters","onClose"])])),_:1},8,["modelValue"]),(0,t.bF)(T,{modelValue:b.dialog.form.show,"onUpdate:modelValue":l[2]||(l[2]=e=>b.dialog.form.show=e),persistent:"","transition-show":"slide-down","transition-hide":"none"},{default:(0,t.k6)((()=>[(0,t.bF)(S,{parameters:b.dialog.form.parameters,onClose:f.on_close_dialog_form},null,8,["parameters","onClose"])])),_:1},8,["modelValue"])],64)}a(239);var _=a(8734),f=a(9928),g=a(8916),k=a(526),v=a(3336);const y={props:["parameters"],emits:["close"],components:{Pick:(0,t.$V)((()=>a.e(472).then(a.bind(a,9472)))),Table2:(0,t.$V)((()=>a.e(123).then(a.bind(a,1123)))),FormE:(0,t.$V)((()=>a.e(901).then(a.bind(a,901))))},setup(){return{id:(0,_.KR)(null),is_edit:(0,_.KR)(!1),saving:(0,_.KR)(!1),index:(0,_.KR)(null),fields:(0,_.KR)(null),template:(0,_.KR)({options:{}}),row:(0,_.KR)(null),replica:(0,_.KR)(null),enums:(0,_.KR)({}),options:(0,_.KR)({}),loading:(0,_.KR)({}),dialog:(0,_.KR)({form:{show:!1,parameters:null},pick:{show:!1,parameters:null},table:{show:!1,parameters:null}})}},created(){let e=this;e.fields=[],e.is_edit=!1;let l=v.V.get.object(e.parameters);e.replica=v.V.get.number(l.replica,null),e.template=v.V.get.object(l.template),e.enums={},f.Z.isObject(e.template.enums)&&Object.keys(e.template.enums).forEach((l=>{e.enums[l]=[null].concat(e.template.enums[l])})),e.options={},f.Z.isObject(e.template.options)&&Object.keys(e.template.options).forEach((l=>{e.options[l]=[null].concat(e.template.options[l])})),e.row=v.V.get.object(l.row);let a=v.V.get.array(e.template.fields);if(a.length)if(f.Z.isObject(l.row)){e.index=l.index,e.id=v.V.id.fromPk(e.template.id,l.row._pk_),e.is_edit=f.Z.isDefined(e.id);for(const t of a){let a=v.V.clone.field(t);a.value=f.Z.getFieldValue(a.name,l.row),!f.Z.isDefined(a.value)&&f.Z.isFunction(a.rowToValue)&&(a.value=a.rowToValue(l.row)),"datetime"===a.type&&"epoch"===a.converter?a.value=f.Z.format.date(a.value,{format:a.pattern||null}):"pick"===a.type&&(f.Z.isDefined(a.value)&&null!==a.value?a.text=f.Z.isFunction(a.format)?a.format(a.value,l.row):a.value+"":a.text=f.Z.isFunction(a.format)?a.format(null,l.row):""),e.is_edit||(a.editable=a.insertable),e.fields.push(a)}}else for(const t of a)if(t.insertable){let l=v.V.clone.field(t);l.editable=l.insertable,e.fields.push(l)}},methods:{on_form_click(e,l){let a=this,t=v.V.get.object(a.parameters),o=v.V.get.object(t.row),i=v.V.get.array(e.relations);if(!i.length)return void g.L.error("error.required","label.relation");let n=[];for(const d of i)d.value=f.Z.getFieldValue(d.source,o),n.push({field:d.target,condition:"EQUAL",value:d.value});let s=v.V.copy(e.crud);s.filters=f.Z.isArray(s.filters)?s.filters:[],s.filters=s.filters.concat(n),f.Z.isNumber(a.replica)&&(s.replica=a.replica),a.loading["form_"+l]=!0,k.F.call({path:"/crud/single",method:"post",data:s,onFinish(){a.loading["form_"+l]=!1},onSuccess(l){l=v.V.get.object(l),v.V.inject.pkAndGridId(e.id,l,a.template._grid_id_),a.dialog.form={show:!0,parameters:{form:e,template:a.template,row:o,data:l,replica:a.replica,relations:i,is_edit:f.Z.isDefined(l._pk_)}}}})},on_close_dialog_form(){let e=this;e.dialog.form={show:!1,parameters:null}},on_pick_select_click(e){let l=this,a=l.template.picks[e.pick];f.Z.isObject(a)?l.dialog.pick={show:!0,parameters:{template:l.template,field:e,pick:a,replica:l.replica}}:g.L.error("error.required","label.pick")},on_pick_remove_click(e){e.value=void 0,e.text=void 0},on_close_dialog_pick(e){let l=this;if(e?._pk_){let a=l.dialog.pick.parameters.field,t=f.Z.isFunction(a.format)?a.format(e):e+"";a.value=e,a.text=t}l.dialog.pick={show:!1,parameters:null,field:null}},on_table_click(e){let l=this,a=v.V.get.object(l.parameters),t=v.V.get.object(a.template),o=v.V.get.object(a.row),i=v.V.copy(v.V.get.array(e.relations));if(i.length){for(const e of i)e.value=f.Z.getFieldValue(e.source,o);e._grid_id_=t._grid_id_,l.dialog.table={show:!0,parameters:{template:t,definition:e,parentRow:o,relations:i,onlyView:!1,replica:l.replica}}}else g.L.error("error.required","label.relation")},on_close_dialog_table(e){let l=this;l.dialog.table={show:!1,parameters:null}},on_clone_click(){let e=this,l=e.row?v.V.copy(e.row):null;if(l?._pk_){delete l._pk_;let a=e.template.id;"STANDARD"===a.type&&delete l[a.fields[0]]}e.$emit("close",{row:l,is_edit:e.is_edit})},on_save_click(){let e=this;v.V.action.save({id:e.id,fields:e.fields,definition:e.template,replica:e.replica,is_edit:e.is_edit,saving:e.saving,onSuccess:function(l){if(!0===e.is_edit){e.saving=!0;let l=v.V.copy(e.template.crud);l.id=v.V.copy(e.id),l.replica=e.replica,k.F.call({path:"/crud/single",method:"post",data:l,onFinish(){e.saving=!1},onSuccess(l){f.Z.isObject(l)&&(l._grid_id_=e.row._grid_id_,l._pk_=e.row._pk_),e.$emit("close",{row:l,is_edit:e.is_edit,index:e.index})}})}else e.$emit("close",{row:l,is_edit:e.is_edit,index:e.index})}})}}};var h=a(2807),V=a(7569),w=a(7066),x=a(5329),q=a(3418),F=a(5779),C=a(9001),A=a(8151),Q=a(8020),U=a(3694),X=a(4609),W=a(7308),Z=a(4873),$=a(6721),j=a(7015),K=a(4082),L=a(3815),R=a(3145),T=a(9765),E=a(2467),S=a(1089),I=a(6334),D=a(7201),P=a(2769),O=a(8582),B=a.n(O);const N=(0,h.A)(y,[["render",b]]),G=N;B()(y,"components",{QCard:V.A,QCardSection:w.A,QItem:x.A,QItemSection:q.A,QItemLabel:F.A,QBtn:C.A,QTooltip:A.A,QInput:Q.A,QSelect:U.A,QIcon:X.A,QPopupProxy:W.A,QTabs:Z.A,QTab:$.A,QSeparator:j.A,QTabPanels:K.A,QTabPanel:L.A,QDate:R.A,QTime:T.A,QFab:E.A,QFabAction:S.A,QCardActions:I.A,QDialog:D.A}),B()(y,"directives",{ClosePopup:P.A})}}]);