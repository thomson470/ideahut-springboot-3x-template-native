"use strict";(globalThis["webpackChunkideahut_quasar_template"]=globalThis["webpackChunkideahut_quasar_template"]||[]).push([[852],{9852:(e,t,l)=>{l.r(t),l.d(t,{default:()=>A});var a=l(1758),s=l(8790);const r={class:"q-mt-none q-pa-sm q-mb-lg"},n={class:"col-md-3 col-xs-12 text-center flex flex-center",style:{"border-right":"solid 0.5px"}},i={class:"col-md-9 col-xs-12"},o={class:"text-right"},d={class:"text-right"};function u(e,t,l,u,g,c){const m=(0,a.g2)("q-tooltip"),p=(0,a.g2)("q-btn"),b=(0,a.g2)("q-table"),_=(0,a.g2)("q-card-section"),h=(0,a.g2)("q-card"),f=(0,a.g2)("q-item-label"),k=(0,a.g2)("q-item-section"),y=(0,a.g2)("q-item"),v=(0,a.g2)("q-icon"),F=(0,a.g2)("q-input"),I=(0,a.g2)("q-badge"),w=(0,a.g2)("View"),q=(0,a.g2)("q-dialog");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",r,[(0,a.bF)(h,{class:"q-pa-none q-mb-xl",bordered:""},{default:(0,a.k6)((()=>[(0,a.bF)(_,{class:"row q-pa-none"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",n,[null!==u.running?((0,a.uX)(),(0,a.Wv)(p,{key:0,round:"",glossy:"",class:"q-mb-sm q-mt-sm",icon:u.running?"stop_circle":"play_circle",color:u.running?"negative":"positive",size:"5vh",loading:u.loading.start_stop,onClick:c.on_start_stop_click},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$t(u.running?"label.stop":"label.start")),1)])),_:1})])),_:1},8,["icon","color","loading","onClick"])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",i,[(0,a.Lk)("div",o,[(0,a.bF)(p,{round:"",glossy:"",dense:"",size:"sm",icon:"refresh",class:"q-ma-xs",loading:u.loading.metadata,onClick:c.get_metadata},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$t("label.refresh")),1)])),_:1})])),_:1},8,["loading","onClick"])]),u.metadata?.length?((0,a.uX)(),(0,a.Wv)(b,{key:0,class:"table-sticky-header no-column q-ma-xs",style:{"max-height":"28vh"},rows:u.metadata,separator:"horizontal","rows-per-page-options":[0],"hide-bottom":"","hide-header":"",dense:"",flat:"",bordered:""},null,8,["rows"])):(0,a.Q3)("",!0)])])),_:1})])),_:1}),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(u.groups,((t,l)=>((0,a.uX)(),(0,a.Wv)(h,{key:l,class:"q-pa-none q-mb-lg",bordered:""},{default:(0,a.k6)((()=>[(0,a.bF)(y,null,{default:(0,a.k6)((()=>[(0,a.bF)(k,null,{default:(0,a.k6)((()=>[(0,a.bF)(f,{class:"text-h5"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(t.name),1)])),_:2},1024),(0,a.bF)(f,{class:"text-italic",caption:""},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$t("label.zone_offset_seconds"))+": "+(0,s.v_)(t.zoneOffsetSeconds),1)])),_:2},1024),(0,a.bF)(f,{class:"ellipsis-text lines2",caption:""},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(t.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),u.expand[l]?((0,a.uX)(),(0,a.Wv)(_,{key:0,class:"q-pa-xs"},{default:(0,a.k6)((()=>[(0,a.bF)(b,{class:"table-sticky-header",rows:t.triggers,"visible-columns":u.visibles,columns:u.columns,"row-key":"triggerId",loading:u.loading[l],pagination:u.pagination[l],filter:u.filter[l],"binary-state-sort":"",separator:"cell",selection:"single"},{"top-right":(0,a.k6)((()=>[(0,a.bF)(F,{borderless:"",dense:"",modelValue:u.filter[t.groupId],"onUpdate:modelValue":e=>u.filter[t.groupId]=e,placeholder:e.$t("label.search")},{append:(0,a.k6)((()=>[(0,a.bF)(v,{name:"search"})])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),(0,a.bF)(p,{round:"",glossy:"",dense:"",size:"sm",icon:"refresh",class:"q-ml-lg",loading:u.loading.group[l],onClick:e=>c.get_triggers(l)},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$t("label.refresh")),1)])),_:1})])),_:2},1032,["loading","onClick"])])),"body-selection":(0,a.k6)((t=>[(0,a.Lk)("div",d,[t.row?.status?.state&&"PAUSED"===t.row.status.state?((0,a.uX)(),(0,a.Wv)(p,{key:0,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"green-9",icon:"play_arrow",loading:u.loading.pause_resume[t.row.triggerId],onClick:e=>c.on_resume_click(t)},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$t("label.resume")),1)])),_:1})])),_:2},1032,["loading","onClick"])):(0,a.Q3)("",!0),t.row?.status?.state&&"PAUSED"!==t.row.status.state?((0,a.uX)(),(0,a.Wv)(p,{key:1,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"orange-9",icon:"pause",loading:u.loading.pause_resume[t.row.triggerId],onClick:e=>c.on_pause_click(t)},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$t("label.pause")),1)])),_:1})])),_:2},1032,["loading","onClick"])):(0,a.Q3)("",!0),t.row?.status&&!0!==t.row.status.scheduled?((0,a.uX)(),(0,a.Wv)(p,{key:2,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"indigo-9",icon:"add",loading:u.loading.schedule_unschedule[t.row.triggerId],onClick:e=>c.on_schedule_click(t)},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$t("label.schedule")),1)])),_:1})])),_:2},1032,["loading","onClick"])):(0,a.Q3)("",!0),t.row?.status&&!0===t.row.status.scheduled?((0,a.uX)(),(0,a.Wv)(p,{key:3,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"pink-9",icon:"remove",loading:u.loading.schedule_unschedule[t.row.triggerId],onClick:e=>c.on_unschedule_click(t)},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$t("label.unschedule")),1)])),_:1})])),_:2},1032,["loading","onClick"])):(0,a.Q3)("",!0),t.row?.status&&!0===t.row.status.scheduled?((0,a.uX)(),(0,a.Wv)(p,{key:4,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"blue-grey-9",icon:"directions_run",loading:u.loading.trigger[t.row.triggerId],onClick:e=>c.on_trigger_click(t)},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$t("label.trigger")),1)])),_:1})])),_:2},1032,["loading","onClick"])):(0,a.Q3)("",!0),(0,a.bF)(p,{glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"deep-purple",icon:"visibility",onClick:e=>c.on_view_click(t)},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$t("label.view")),1)])),_:1})])),_:2},1032,["onClick"])])])),_:2},1032,["rows","visible-columns","columns","loading","pagination","filter"])])),_:2},1024)):(0,a.Q3)("",!0),(0,a.bF)(I,{color:"transparent",floating:"",transparent:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{round:"",glossy:"",dense:"",size:"sm",class:"q-ma-sm",icon:u.expand[l]?"keyboard_arrow_up":"keyboard_arrow_down",onClick:e=>u.expand[l]=!u.expand[l]},null,8,["icon","onClick"])])),_:2},1024)])),_:2},1024)))),128))]),(0,a.bF)(q,{modelValue:u.dialog.view.show,"onUpdate:modelValue":t[0]||(t[0]=e=>u.dialog.view.show=e),persistent:"","transition-show":"slide-down","transition-hide":"none"},{default:(0,a.k6)((()=>[(0,a.bF)(w,{parameters:u.dialog.view.parameters},null,8,["parameters"])])),_:1},8,["modelValue"])],64)}l(239);var g=l(8734),c=l(9928),m=l(8916),p=l(526);const b={components:{View:(0,a.$V)((()=>Promise.all([l.e(121),l.e(226)]).then(l.bind(l,9226))))},setup(){return{util:c.Z,handler:(0,g.KR)(null),running:(0,g.KR)(null),metadata:(0,g.KR)([]),groups:(0,g.KR)({}),columns:(0,g.KR)([]),visibles:(0,g.KR)([]),filter:(0,g.KR)({}),expand:(0,g.KR)({}),pagination:(0,g.KR)({}),loading:(0,g.KR)({start_stop:!1,metadata:!1,group:{},pause_resume:{},schedule_unschedule:{},trigger:{}}),dialog:(0,g.KR)({view:{show:!1,parameters:null}})}},created(){let e=this;e.visibles=["name","cronExpression","type.classname","isRunOnStartup","status.state","status.priority","zoneOffsetSeconds","status.startTime","status.previousFireTime","status.nextFireTime"],e.columns=[{name:"triggerId",label:e.$t("label.id"),field:"triggerId",align:"left",sortable:!0},{name:"name",label:e.$t("label.name"),field:"name",align:"left",sortable:!0},{name:"cronExpression",label:e.$t("label.cron"),field:"cronExpression",align:"left",sortable:!0},{name:"type.classname",label:e.$t("label.class"),field:"type",align:"left",sortable:!0,format:function(e){return e?e.classname:e.name}},{name:"isRunOnStartup",label:e.$t("label.run_on_startup"),field:"isRunOnStartup",align:"center",sortable:!0,format:function(t){return"Y"===t?e.$t("label.yes"):"N"===t?e.$t("label.no"):""}},{name:"isSaveResult",label:e.$t("label.save"),field:"isSaveResult",align:"center",sortable:!0,format:function(t){return"Y"===t?e.$t("label.yes"):"N"===t?e.$t("label.no"):""}},{name:"status.state",label:e.$t("label.state"),field:"status",align:"center",sortable:!0,format:function(e){return e?e.state:""}},{name:"status.priority",label:e.$t("label.priority"),field:"status",align:"center",sortable:!0,format:function(e){return e&&c.Z.isNumber(e.priority)?e.priority:""}},{name:"zoneOffsetSeconds",label:e.$t("label.zone_offset_seconds"),field:"zoneOffsetSeconds",align:"left",sortable:!0},{name:"status.startTime",label:e.$t("label.start_time"),field:"status",align:"center",format:function(e){return e&&c.Z.isNumber(e.startTime)?c.Z.format.date(e.startTime,{format:"yyyy-MM-dd HH:mm:ss"}):""}},{name:"status.previousFireTime",label:e.$t("label.previous_fire_time"),field:"status",align:"center",format:function(e){return e&&c.Z.isNumber(e.previousFireTime)?c.Z.format.date(e.previousFireTime,{format:"yyyy-MM-dd HH:mm:ss"}):""}},{name:"status.nextFireTime",label:e.$t("label.next_fire_time"),field:"status",align:"center",format:function(e){return e&&c.Z.isNumber(e.nextFireTime)?c.Z.format.date(e.nextFireTime,{format:"yyyy-MM-dd HH:mm:ss"}):""}},{name:"type",label:e.$t("label.type"),field:"type",align:"left"},{name:"status",label:e.$t("label.status"),field:"status",align:"left"}],e.do_init()},methods:{do_init(){let e=this,t=e.$route.query.handler;t!==e.handler&&(e.handler=t,e.get_metadata(),e.get_groups())},get_metadata(){let e=this;e.loading.metadata=!0,p.F.call({path:"/scheduler/metadata",params:{handler:e.handler},onFinish(){e.loading.metadata=!1},onSuccess(t,l){e.running=l.running,e.metadata=[],c.Z.isObject(t)&&Object.keys(t).forEach((l=>{e.metadata.push({label:l.substring(0,1).toUpperCase()+l.substring(1),value:"runningSince"===l?c.Z.format.date(t[l],{format:"yyyy-MM-dd HH:mm:ss"}):t[l]})})),c.Z.isArray(l.packages)&&e.metadata.push({label:"JobPackages",value:JSON.stringify(l.packages)})}})},retrieve_group(e,t,l){let a=this;a.groups[e.groupId]=e,a.loading.group[e.groupId]=!1,a.filter[e.groupId]=l[e.groupId]?l[e.groupId]:null,a.expand[e.groupId]=!0===t[e.groupId],a.pagination[e.groupId]={page:1,rowsPerPage:20,sortBy:"name",descending:!1}},get_groups(){let e=this;p.F.call({path:"/scheduler/groups",params:{handler:e.handler},onSuccess(t){if(c.Z.isArray(t)){let l=JSON.parse(JSON.stringify(e.expand)),a=JSON.parse(JSON.stringify(e.filter));e.groups={},e.expand={},e.filter={};for(const s of t)e.retrieve_group(s,l,a),e.get_triggers(s.groupId)}}})},get_triggers(e){let t=this;c.Z.isString(e)&&(t.loading.group[e]=!0),p.F.call({path:"/scheduler/triggers",params:{handler:t.handler,groupId:c.Z.isString(e)?e:null},onFinish(){c.Z.isString(e)&&(t.loading.group[e]=!1)},onSuccess(l){if(c.Z.isArray(l)){let a=JSON.parse(JSON.stringify(t.expand)),s=JSON.parse(JSON.stringify(t.filter));if(c.Z.isString(e))t.retrieve_group(l[0],a,s);else{t.groups={},t.expand={};for(const e of l)t.retrieve_group(e,a,s)}}}})},on_start_stop_click(){let e=this;m.L.confirm((function(){e.loading.start_stop=!0,p.F.call({path:"/scheduler/"+(e.running?"stop":"start"),method:"post",params:{handler:e.handler},onFinish(){e.loading.start_stop=!1},onSuccess(){e.get_metadata(),e.get_groups()}})}),e.$t("label."+(e.running?"stop":"start"))+" ?",!1)},on_pause_click(e){let t=this,l=e.row;m.L.confirm((function(){t.loading.pause_resume[l.triggerId]=!0,p.F.call({path:"/scheduler/pause",method:"post",params:{handler:t.handler,triggerId:l.triggerId},onFinish(){t.loading.pause_resume[l.triggerId]=!1},onSuccess(){t.get_triggers(l.group.groupId)}})}),t.$t("label.pause")+" <b>"+l.name+"</b> ?",!1)},on_resume_click(e){let t=this,l=e.row;m.L.confirm((function(){t.loading.pause_resume[l.triggerId]=!0,p.F.call({path:"/scheduler/resume",method:"post",params:{handler:t.handler,triggerId:l.triggerId},onFinish(){t.loading.pause_resume[l.triggerId]=!1},onSuccess(){t.get_triggers(l.group.groupId)}})}),t.$t("label.resume")+" <b>"+l.name+"</b> ?",!1)},on_schedule_click(e){let t=this,l=e.row;m.L.confirm((function(){t.loading.schedule_unschedule[l.triggerId]=!0,p.F.call({path:"/scheduler/add",method:"post",params:{handler:t.handler,triggerId:l.triggerId},onFinish(){t.loading.schedule_unschedule[l.triggerId]=!1},onSuccess(){t.get_triggers(l.group.groupId)}})}),t.$t("label.schedule")+" <b>"+l.name+"</b> ?",!1)},on_unschedule_click(e){let t=this,l=e.row;m.L.confirm((function(){t.loading.schedule_unschedule[l.triggerId]=!0,p.F.call({path:"/scheduler/delete",method:"post",params:{handler:t.handler,triggerId:l.triggerId},onFinish(){t.loading.schedule_unschedule[l.triggerId]=!1},onSuccess(){t.get_triggers(l.group.groupId)}})}),t.$t("label.unschedule")+" <b>"+l.name+"</b> ?",!1)},on_trigger_click(e){let t=this,l=e.row;m.L.confirm((function(){t.loading.trigger[l.triggerId]=!0,p.F.call({path:"/scheduler/trigger",method:"post",params:{handler:t.handler,triggerId:l.triggerId},onFinish(){t.loading.trigger[l.triggerId]=!1},onSuccess(){t.get_triggers(l.group.groupId)}})}),t.$t("label.trigger")+" <b>"+l.name+"</b> ?",!1)},on_view_click(e){let t=this;t.dialog.view={show:!0,parameters:{scope:e,columns:t.columns}}}}};var _=l(2807),h=l(7569),f=l(7066),k=l(9001),y=l(8151),v=l(3621),F=l(5329),I=l(3418),w=l(5779),q=l(8020),x=l(4609),$=l(4031),S=l(7201),C=l(8582),W=l.n(C);const Q=(0,_.A)(b,[["render",u]]),A=Q;W()(b,"components",{QCard:h.A,QCardSection:f.A,QBtn:k.A,QTooltip:y.A,QTable:v.A,QItem:F.A,QItemSection:I.A,QItemLabel:w.A,QInput:q.A,QIcon:x.A,QBadge:$.A,QDialog:S.A})}}]);