"use strict";(globalThis["webpackChunkideahut_quasar_admin"]=globalThis["webpackChunkideahut_quasar_admin"]||[]).push([[191],{2191:(e,l,t)=>{t.r(l),t.d(l,{default:()=>A});var a=t(1758),o=t(8790);const i={key:0,class:"q-mb-xs",style:{width:"100%"}},s={key:1,class:"q-mb-xs",style:{width:"100%"}};function r(e,l,t,r,n,d){const u=(0,a.g2)("q-item-label"),c=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-tooltip"),g=(0,a.g2)("q-btn"),p=(0,a.g2)("q-item"),b=(0,a.g2)("q-card-section"),f=(0,a.g2)("q-input"),h=(0,a.g2)("q-card"),_=(0,a.g2)("FormV"),V=(0,a.g2)("q-dialog"),w=(0,a.g2)("Table2"),k=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(h,{style:(0,o.Tr)("width: "+(e.$q.screen.lt.md?"100%;":"50%;"))},{default:(0,a.k6)((()=>[(0,a.bF)(b,{class:"header-main"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{class:"q-pr-none"},{default:(0,a.k6)((()=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(u,{class:"text-h6 text-white"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(r.title),1)])),_:1})])),_:1}),(0,a.bF)(c,{side:""},{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close"},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.$t("label.close")),1)])),_:1})])),_:1})),[[k]])])),_:1})])),_:1})])),_:1}),(0,a.bF)(b,{style:{"max-height":"75vh"},class:"q-pa-xs q-mt-none scroll"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.fields,((e,l)=>((0,a.uX)(),(0,a.Wv)(f,{type:"text",key:l,label:e.label,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,readonly:"",filled:"",autogrow:"",class:"q-mb-xs",style:{"max-height":"120px",overflow:"scroll"}},null,8,["label","modelValue","onUpdate:modelValue"])))),128)),r.forms.length?((0,a.uX)(),(0,a.CE)("div",i,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.forms,((e,l)=>((0,a.uX)(),(0,a.Wv)(g,{key:l,label:e.title,class:"full-width q-mt-xs q-mb-xs text-weight-bold","no-caps":"",glossy:"",loading:r.loading["form_"+l],onClick:t=>d.on_form_click(e,l)},null,8,["label","loading","onClick"])))),128))])):(0,a.Q3)("",!0),r.tables.length?((0,a.uX)(),(0,a.CE)("div",s,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.tables,((e,l)=>((0,a.uX)(),(0,a.Wv)(g,{key:l,label:e.title,class:"full-width q-mt-xs q-mb-xs text-weight-bold","no-caps":"",glossy:"",onClick:l=>d.on_table_click(e)},null,8,["label","onClick"])))),128))])):(0,a.Q3)("",!0)])),_:1})])),_:1},8,["style"]),(0,a.bF)(V,{modelValue:r.dialog.form.show,"onUpdate:modelValue":l[0]||(l[0]=e=>r.dialog.form.show=e),persistent:"","transition-show":"slide-down","transition-hide":"none"},{default:(0,a.k6)((()=>[(0,a.bF)(_,{parameters:r.dialog.form.parameters},null,8,["parameters"])])),_:1},8,["modelValue"]),(0,a.bF)(V,{modelValue:r.dialog.table.show,"onUpdate:modelValue":l[1]||(l[1]=e=>r.dialog.table.show=e),"transition-show":"slide-down","transition-hide":"none","full-height":"","full-width":""},{default:(0,a.k6)((()=>[(0,a.bF)(w,{parameters:r.dialog.table.parameters,onClose:d.on_close_dialog_table},null,8,["parameters","onClose"])])),_:1},8,["modelValue"])],64)}t(239);var n=t(8734),d=t(9928),u=t(526),c=t(8916),m=t(3336);const g={props:["parameters"],components:{FormV:(0,a.$V)((()=>t.e(9).then(t.bind(t,6009)))),Table2:(0,a.$V)((()=>t.e(123).then(t.bind(t,1123))))},setup(){return{util:d.Z,title:(0,n.KR)(null),fields:(0,n.KR)([]),forms:(0,n.KR)([]),tables:(0,n.KR)([]),loading:(0,n.KR)({}),replica:(0,n.KR)(null),dialog:(0,n.KR)({form:{show:!1,parameters:null},table:{show:!1,parameters:null}})}},created(){let e=this,l=m.V.get.object(e.parameters),t=m.V.get.object(l.row),a=m.V.get.object(l.template);e.title=d.Z.isString(l.title)?l.title:a.title,e.replica=m.V.get.number(l.replica,null),e.fields=[];let o,i=m.V.get.array(a.table.columns),s=!1;for(const r of i)!s&&a.id.fields.includes(r.field)&&(s=!0),o=d.Z.getFieldValue(r.field,t),d.Z.isFunction(r.format)&&(o=r.format(o,t)),e.fields.push({label:r.label,value:o});if(!s){let l=m.V.id.toPk(a.id,t);d.Z.isDefined(l)&&null!==l&&e.fields.splice(0,0,{label:"ID",value:l})}e.forms=m.V.get.array(a.forms),e.tables=m.V.get.array(a.children)},methods:{on_form_click(e,l){let t=this,a=m.V.get.object(t.parameters),o=m.V.get.object(a.template),i=m.V.get.object(a.row),s=m.V.get.array(e.relations);if(!s.length)return void c.L.error("error.required","label.relation");let r=[];for(const u of s)r.push({field:u.target,condition:"EQUAL",value:d.Z.getFieldValue(u.source,i)});let n=m.V.copy(e.crud);n.filters=d.Z.isArray(n.filters)?n.filters:[],n.filters=n.filters.concat(r),d.Z.isNumber(t.replica)&&(n.replica=t.replica),t.loading["form_"+l]=!0,u.F.call({path:"/crud/single",method:"post",data:n,onFinish(){t.loading["form_"+l]=!1},onSuccess(l){l=m.V.get.object(l),m.V.inject.pkAndGridId(e.id,l,o._grid_id_),t.dialog.form={show:!0,parameters:{form:e,data:l,replica:t.replica}}}})},on_table_click(e){let l=this,t=m.V.get.object(l.parameters),a=m.V.get.object(t.template),o=m.V.get.object(t.row),i=m.V.copy(m.V.get.array(e.relations));if(i.length){for(const e of i)e.value=d.Z.getFieldValue(e.source,o);e._grid_id_=a._grid_id_,l.dialog.table={show:!0,parameters:{template:a,definition:e,parentRow:o,relations:i,onlyView:!0,replica:l.replica}}}else c.L.error("error.required","label.relation")},on_close_dialog_table(e){let l=this;l.dialog.table={show:!1,parameters:null}}}};var p=t(2807),b=t(7569),f=t(7066),h=t(5329),_=t(3418),V=t(5779),w=t(9001),k=t(8151),q=t(8020),y=t(7201),F=t(2769),v=t(8582),x=t.n(v);const C=(0,p.A)(g,[["render",r]]),A=C;x()(g,"components",{QCard:b.A,QCardSection:f.A,QItem:h.A,QItemSection:_.A,QItemLabel:V.A,QBtn:w.A,QTooltip:k.A,QInput:q.A,QDialog:y.A}),x()(g,"directives",{ClosePopup:F.A})}}]);